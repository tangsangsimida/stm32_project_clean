
# ğŸ‘ˆç”¨æˆ·å¤´æ–‡ä»¶è·¯å¾„ 
set(USER_Include_Dirs
    ${CMAKE_CURRENT_SOURCE_DIR}/Application/inc
    ${CMAKE_CURRENT_SOURCE_DIR}/Peripherals/inc
    $<TARGET_PROPERTY:stm32cubemx,INTERFACE_INCLUDE_DIRECTORIES>  # âœ… è‡ªåŠ¨ä» CubeMX è·å–å¤´æ–‡ä»¶è·¯å¾„
)

# ğŸ‘ˆè‡ªåŠ¨æ”¶é›† Application/Src ä¸‹çš„æ‰€æœ‰ .c æºæ–‡ä»¶
file(GLOB_RECURSE USER_Application_Src
    "${CMAKE_CURRENT_SOURCE_DIR}/Application/src/*.c"
    "${CMAKE_CURRENT_SOURCE_DIR}/Application/src/*.cpp"
)

# ğŸ‘ˆè‡ªåŠ¨æ”¶é›† Peripherals/Src ä¸‹çš„æ‰€æœ‰ .c æºæ–‡ä»¶
file(GLOB_RECURSE USER_Peripherals_Src
    "${CMAKE_CURRENT_SOURCE_DIR}/Peripherals/src/*.c"
    "${CMAKE_CURRENT_SOURCE_DIR}/Peripherals/src/*.cpp"
)

# ğŸ‘ˆåˆå¹¶æ‰€æœ‰ç”¨æˆ·æºæ–‡ä»¶
set(USER_Sources
    ${USER_Application_Src}
    ${USER_Peripherals_Src}
)

# ğŸ‘ˆæ¥å£åº“ï¼šç”¨äºå…±äº«å¤´æ–‡ä»¶å’Œå®å®šä¹‰
add_library(user_interface INTERFACE)
target_include_directories(user_interface INTERFACE
    ${USER_Include_Dirs}
)


# ğŸ‘ˆå¯¹è±¡åº“ï¼šåŒ…å«å®é™…ç¼–è¯‘çš„ç”¨æˆ·ä»£ç 
add_library(user_objects OBJECT)
target_sources(user_objects PRIVATE
    ${USER_Sources}
)

target_link_libraries(user_objects PUBLIC user_interface stm32cubemx STM32_Drivers)

# ğŸ‘ˆå°†å˜é‡æš´éœ²ç»™çˆ¶çº§ CMakeLists.txt
set(USER_Sources ${USER_Sources} PARENT_SCOPE)
set(USER_Include_Dirs ${USER_Include_Dirs} PARENT_SCOPE)
